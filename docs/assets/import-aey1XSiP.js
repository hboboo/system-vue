import{r as h,u as g}from"./xlsx-uoQkVabA.js";import{_ as w,r as i,c as y,d as k,a,w as r,b as s,o as v,g as u}from"./index-CWHsYAsn.js";const N={class:"import-container"},S={class:"handle-box"},B={__name:"import",setup(D){const c=i([]);(()=>{c.value=[{id:1,name:"小明",sno:"S001",class:"一班",age:"10",sex:"男"},{id:2,name:"小红",sno:"S002",class:"一班",age:"9",sex:"女"}]})();const _=i([]),m=async l=>{const e=new FileReader;e.readAsArrayBuffer(l);const o=await new Promise((d,f)=>{e.onload=x=>d(x.target.result),e.onerror=()=>f(new Error("Failed to read file"))}),n=h(new Uint8Array(o),{type:"array"}),p=n.SheetNames[0],t=g.sheet_to_json(n.Sheets[p]);return _.value=t,!0},b=async()=>{const l=_.value.map((e,o)=>({id:o,name:e.姓名,sno:e.学号,class:e.班级,age:e.年龄,sex:e.性别}));c.value.push(...l)};return(l,e)=>{const o=s("el-button"),n=s("el-upload"),p=s("el-link"),t=s("el-table-column"),d=s("el-table");return v(),y("div",N,[k("div",S,[a(n,{action:"#",limit:1,accept:".xlsx, .xls","show-file-list":!1,"before-upload":m,"http-request":b},{default:r(()=>[a(o,{type:"success"},{default:r(()=>e[0]||(e[0]=[u("批量导入")])),_:1})]),_:1}),a(p,{class:"link",href:"/template.xlsx",target:"_blank"},{default:r(()=>e[1]||(e[1]=[u("下载模板")])),_:1})]),a(d,{data:c.value,border:"",class:"table","header-cell-style":{background:"#f4f6f8"}},{default:r(()=>[a(t,{prop:"id",label:"ID",width:"55",align:"center"}),a(t,{prop:"name",label:"姓名"}),a(t,{prop:"sno",label:"学号"}),a(t,{prop:"class",label:"班级"}),a(t,{prop:"age",label:"年龄"}),a(t,{prop:"sex",label:"性别"})]),_:1},8,["data"])])}}},E=w(B,[["__scopeId","data-v-923f2511"]]);export{E as default};
