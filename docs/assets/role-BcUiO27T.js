import{T as z}from"./TableSearch-DZwJgh6l.js";import{T as U}from"./TableCustom-DzejWlNC.js";import{_ as N,a as H}from"./TableEdit-DPYP1WhN.js";import{r as a,b,o as v,c as $,a as n,e as B,w as l,g as m,m as L,h as P,i as _}from"./index-CWHsYAsn.js";import{a as M}from"./index-COWToMlm.js";const R={__name:"rolePermission",props:{permissOptions:{type:Object,required:!0}},setup(q){const g=q,i=a({}),p=u=>u.map(t=>{const r={id:t.id,label:t.title};return t.children&&(i.value[t.id]=t.children.map(c=>c.id),r.children=p(t.children)),r}),f=u=>u.filter(t=>i.value[t]?i.value[t].every(y=>u.includes(y)):!0),h=p(L),w=a(f(g.permissOptions.permiss)),d=a(),x=()=>{if(!d.value){console.error("Tree component is not initialized");return}const u=d.value.getCheckedKeys(!1),t=d.value.getHalfCheckedKeys(),r=[...u,...t];console.log("Selected permission IDs:",r)};return(u,t)=>{const r=b("el-tree"),c=b("el-button");return v(),$("div",null,[n(r,{ref_key:"tree",ref:d,data:B(h),"node-key":"id","default-expand-all":"","show-checkbox":"","default-checked-keys":w.value},null,8,["data","default-checked-keys"]),n(c,{type:"primary",onClick:x},{default:l(()=>t[0]||(t[0]=[m("保存权限")])),_:1})])}}},Y={__name:"role",setup(q){const g=P({name:""}),i=a(!1),p=a(!1),f=a({}),h=s=>{f.value={...s},p.value=!0,i.value=!0},w=()=>{d(),r()},d=()=>{i.value=!1,p.value=!1,f.value={}},x=a([{type:"input",label:"角色名称",prop:"name"}]),u=()=>{c(1)},t=a([]),r=async()=>{const s=await M();t.value=s.data.list,y.total=s.data.pageTotal};r();const c=s=>{y.index=s,r()},y=P({index:1,size:10,total:2});let E=a([{type:"index",label:"序号",width:55,align:"center"},{prop:"name",label:"角色名称"},{prop:"key",label:"角色标识"},{prop:"status",label:"状态"},{prop:"permissions",label:"权限管理"},{prop:"operator",label:"操作",width:250}]);const F=a({labelWidth:"100px",span:24,list:[{type:"input",label:"角色名称",prop:"name",required:!0},{type:"input",label:"角色标识",prop:"key",required:!0},{type:"switch",label:"状态",prop:"status",required:!1,activeText:"启用",inactiveText:"禁用"}]}),D=a(!1),C=a({row:{},list:[],column:1}),I=s=>{C.value.row={...s},C.value.list=[{prop:"id",label:"角色ID"},{prop:"name",label:"角色名称"},{prop:"key",label:"角色标识"},{prop:"status",label:"角色状态"}],D.value=!0},S=s=>{ElMessage.success("删除成功")},V=a(!1),K=a({}),j=s=>{V.value=!0,K.value={id:s.id,permiss:s.permiss}};return(s,e)=>{const O=b("el-button"),k=b("el-tag"),T=b("el-dialog");return v(),$("div",null,[n(z,{query:g,options:x.value,search:u},null,8,["query","options"]),n(U,{columns:B(E),tableData:t.value,total:y.total,viewFunc:I,editFunc:h,"page-change":c,delFunc:S},{toolbarBtn:l(()=>[n(O,{type:"warning",icon:"CirclePlusFilled",onClick:e[0]||(e[0]=o=>i.value=!0)},{default:l(()=>e[4]||(e[4]=[m("新增")])),_:1})]),status:l(({rows:o})=>[o.status?(v(),_(k,{key:0,type:"success"},{default:l(()=>e[5]||(e[5]=[m("启动")])),_:1})):(v(),_(k,{key:1,type:"danger"},{default:l(()=>e[6]||(e[6]=[m("禁用")])),_:1}))]),permissions:l(({rows:o})=>[n(O,{type:"primary",size:"small",plain:"",onClick:W=>j(o)},{default:l(()=>e[7]||(e[7]=[m("管理")])),_:2},1032,["onClick"])]),_:1},8,["columns","tableData","total"]),n(T,{title:p.value?"编辑":"新增",modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value=o),width:"700px","destroy-on-close":"","close-on-click-modal":!1,onClose:d},{default:l(()=>[n(N,{"form-data":f.value,options:F.value,edit:p.value,update:w},null,8,["form-data","options","edit"])]),_:1},8,["title","modelValue"]),n(T,{title:"查看详情",modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=o=>D.value=o),width:"700px","destroy-on-close":""},{default:l(()=>[n(H,{data:C.value},{status:l(({rows:o})=>[o.status?(v(),_(k,{key:0,type:"success"},{default:l(()=>e[8]||(e[8]=[m("启动")])),_:1})):(v(),_(k,{key:1,type:"danger"},{default:l(()=>e[9]||(e[9]=[m("禁用")])),_:1}))]),_:1},8,["data"])]),_:1},8,["modelValue"]),n(T,{title:"权限管理",width:"500px",modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=o=>V.value=o),"destroy-on-close":""},{default:l(()=>[n(R,{"permiss-options":K.value},null,8,["permiss-options"])]),_:1},8,["modelValue"])])}}};export{Y as default};
